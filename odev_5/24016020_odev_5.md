MACHINE LEARNING NEDIR?
    Machine learning, kendisine kazandirilan veriler isiginda yeni veriler ureten, yapay zekanin alt dali olan bir metodolojidir.

SEKTORDE KULLANILAN NESNE TESPIT MODELLERI NELERDIR?
    Genellikle derin öğrenme (Deep Learning) temelli modeller kullanilir. Bu modeller temel olarak ikiye ayrilir:

1) Iki asamalilar
    - Bu sistemlerin calisma prensibi oncelikle goruntunun neresinde nesne olabilecegini belirleyip sonrasinda bu bolgelerin
    ozelliklerini (siniflandirma ve konum) keskinlestirme uzerine kuruludur.
    - Daha yavas ancak daha yuksek dogruluk orani ile calisirlar.

CNN Nedir? (Convolutional neural networks) (Evrisimsel Sinir Agi)
    - Evrisimsel sinir agi, goruntu tanima ve siiıflandirma, nesne algilama ve takibi gibi alanlarda kullanilan bir derin ögrenme alt dalidir.

a. R-CNN (Region-based Convolutional Neural Networks)
    - Nesne tespitinde bir donum noktasidir, bundan onceki sistemlerde hiz ve hassasiyet konusunda bir turlu dengeli sonuclar elde edilemiyordu, az once bahsettigim iki asamali yaklasimla birlikte cok daha dogru ve verimli sonuclar elde edilmeye baslandi.
    - R-CNN modelinin kullanildigi bolgelerden biri tıbbi goruntuleme teknolojileridir. Genellikle tumorleri belirlemek icin kullanilir. Bunun disinda bircok goruntuleme durumlarinda da kullanilir.
    - R-CNN, her bir bolge onerisi icin ayri bir sinir agi kullandigi icin gercek hayat uygulamalarina zaman icinde yetememeye baslamistir. Bu sebepten ayni algoritmayla yeni modellerin olusturulmasi gundeme gelmis ve gerceklestirilmistir. R-CNN, diger daha verimli modellerin gelistirilmesinde oncu rol oynamistir.

b. Fast R-CNN
    - R-CNN modeli az once belirttigimiz durumdan dolayi yavaslamaya baslamis oldugunu soylemistik. Bu gelismeler Fast R-CNN modelinin gelistirilmesine yol acmistir.
    - Bu model, her bir bolge icin farkli bir sinir agi olusturmak yerine tek bir sinir agiyla tum bolgeleri depolar ve bir harita olusturur. Hem depolamadan hem de calisma yukunden kurtulmus olur.
    - Sonrasinda ozellikler ayni algoritmayla keskinlestirilir ve surec sonuclanir.

c. Faster R-CNN
    - Fast R-CNN modeline nazaran bolge onerisi agi kullanarak cok daha hizli calisir.

d. Mask R-CNN
    - Bu model, Faster R-CNN modelinin olusturdugu bounding box'lara segmentasyon maskeleri olusturulan bir dal eklenmis halidir.
(Segmentasyon: Bir goruntu icerisinden, istenilen bolgeyi tanimlayip ayirt etme)

2) Tek Asamalilar
    - Bu modeller, bolge onerisi surecini kapsamazlar. Tek bir sinir agi ile hem konumu(bounding box) hem de siniflandirmayi ayni anda tahmin ederler.
    - Gercek zamanli uygulamalar icin daha uygunlardir.

a. YOLO (You Only Look Once)
    - 2015 yilinda YOLO modeli cikana kadar CNN tabanli modeller kullaniliyordu. Yeni bir surec ile birlikte cok daha hizli sonuclar veren YOLO, yaygin kullanilan nesne tespit modellerinden biri oldu.
    - Gorseli nxn formatindaki izgaralara ayirir, her izgara kendi icerisinde bir nesne olup olmadiginin bilgisini sinir agindan gecirdikten sonra cikti olarak bir vektor(matris) meydana gelir. Bu matris bounding box ozelliklerini icerir.
    - Kullanim alanlari: otonom araclar, robotlar, ilac endustrisi, tarim...

    a1. YOLO V1
        - İlk YOLO versiyonudur.
    
    a2. YOLO V2
        - Farkli boyutlardaki nesneleri algilama sorunu cozuldu.
    
    a3. YOLO V3
    a4. YOLO V4
    a5. YOLO V5
    a6. PP YOLO

b. SSD (Single Shot Detector)
    - YOLO'dan farkli olarak birden fazla olcekte ozellik haritasi kullanarak nesneleri daha iyi tespit eder.

c. RetinaNet
    - Dogruluk olarak iki asamali modellere yaklasmistir. Focal Loss adli bir fonksiyon kullanir.

-------------------------------------------------------------------------------------------------------------------

YOLO'nun temel calisma prensibinden bahsetmistik, simdi daha derine inelim.

Loss Functions (Hata Fonksiyonlari) Nelerdir?

    a. Siniflandirma Kaybi
        - Tahmin edilen nesnenin ne kadar yanlis olduguyla alakalidir.
    
    b. Konum Kaybi
        - Tahmin edilen bounding box'in ne kadar yanlis olduguyla alakalidir.

    c. Guven Kaybi
        - Izgaranin icerisinde nesne olup olmadiginin dogruluk oraniyla alakalidir.

mAP (Ortalama hassasiyet metrigi): Nesne tespit modellerini degerlendirmek icin kullanilan bir metriktir. Yukarida bahsettigimiz hata fonksiyonlarinin matematiksel ifadelerinin toplamlariyla elde edilir.

Hiperparametre nedir?

    - Durumlara gore degisiklik gosteren, modeli olusturan kisinin inisiyatifine bagli olarak degisen parametrelerdir.

    a. Ogrenme hizi
        
        a1. Ilk ogrenme hizi: Egitimin basindaki ilk ogrenme hizidir. Yuksek bir deger hizli bir ogrenmeyi saglar ancak dengesizlige yol acabilir, dusuk deger ise yavaslamaya neden olur.

        a2. Final ogrenme hizi: Egitimin sonunda ulasacagi faktoru belirler.

    b. Batch Size
        
        batch: Bir egitim yinelemesinde (iteration) sinir agina ayni anda beslenen goruntu sayisidir.

        b1. Buyuk batch size: Daha kararli tahminler yurutur ancak GPU belleginde daha cok yer kaplar.

        b2. Kucuk batch size: Daha az bellek kullanir ancak daha dusuk dogrulukta tahminler yapar.

    c. Epochs, Patience

        epochs: Tum egitim veri setinin aga kac kez gosterilecegini gosteren toplam dongu sayisidir.

        patience: Belirli bir surec icerisinde performansin iyilesmemesi durumunda eğitimi durdurmak icin kullanilan mekanizmadir.

    d. Optimizasyon

        momentum, weight_decay, warmup_epochs

    e. Loss Weights (Hata Fonksiyonlari)

    f. Goruntu Boyutu

    g. Cikarim (Inference) 
        - Bu parametreler egitimden sonra tahmin uretme asamasinda kullanilir.

Segmentasyon ve Nesne Tespiti arasindaki fark

    - Segmentasyon islemi, goruntuyu bolgelere ayirarak her bir piksele siniflandirma yaparken; Nesne tespiti islemi nesneleri lokallestirip etrafina bir bounding box cizer. Kabaca segmentasyon goruntudeki hedefin tum alani icin islem yaparken nesne tespiti sadece etrafini sinirlar.
    - Segmentasyon goruntu hakkinda daha ayrintili bilgiler icerir.

s, m, l, x modelleri karsilastirmasi
    - kucuk(s), orta(m), buyuk(l), ekstra buyuk(x) olarak siniflanirlar.
    - Buyudukce daha dogru sonuclar elde edilir.

Ideal Veri Seti
    - YOLO modelini basarili bir sekilde egitmek ve iyi performans elde etmek icin bazi kriterleri saglayan bir veri seti sarttir.

    a. Yuksek kalite ve Etiketleme
        - Her nesnenin bounding box'i dogru olmalidir aksi takdirde model yanlis egitilir.
        - Siniflandirmada etiket dogru yapilmalidir.
        - Goruntuler yuksek cozunurluklu anlasilir olmalidir.

    b. Cesitlilik
        - Aydinlatma, Hava kosullari, Bakis acilari ve mesafe, Degisik arkaplanlar, farkli boyutlar gibi degisken durumlara uygun olmali.

    c. Dengeli Sinif Dagilimi
        - Her bir sinifin ayni ya da yakin miktarda verisi bulunmalidir.

    d. Yeterli Miktar
        - Her bir sinifin yeterli miktarda verisi bulunmalidir.

    YOLO'nun basarisi, butuk olcude veri setine baglidir. Ideal bir veri seti, bu dort ana basligi dengeli bir sekilde karsilayan veri setidir.

Augmentation (veri artirma)
    - Veri setini yapay olarak arttirmak icin kullaninan teknikler butunune denir. Ikiye ayrilir:
        1. Birlestirme Tabanli (Compositonal)
            - Mozaik Artirma: En az dort farkli goruntuyu alip rastgele birlestirir
            - Kopyala-Yapistir: Bir goruntudeki nesneyi alip baska bir goruntuye yerlestirir.
        
        2. Geleneksel (Classical)
            - Geometrik Arttirmalar:
                - Olcekleme ve Kirpma: Nesnelerin farkli boyutlarda ve goruntu icinde farkli konumlarda gorunmesini saglar.
                - Dondurme
                - Yansitma: Goruntuyu dikey veya yatay yansitir.
                - Ceviri: Goruntuyu rastgele bir miktar kaydirir.

            - Renk Alani Arttirmalari
                - HSV (hue, saturation, value) (ton, doygunluk, parlaklik): Bu uc degerin rastgele degistirilmesi
                - Parlaklik/Kontrast degisiklikleri


RoboFlow Nedir?
    - Nesne tespiti uygulamalarini buyuk oranda hizlandiran ve otomatiklestiren bir platformdur.
    Akıs su sekildedir:
        1- Veri yukleme ve yonetimi
            Kullanici goruntuleri yukler, bu verilerle bir proje olusturulurve nesne algilama, siniflandirma, segmentasyon gibi gorevler tanimlanir.

        2- Etiketleme
            Kullanci nesnelerin etrafina sinir kutulari cizer veya segmentasyon maskeleri olusturur ve her nesneye bir sinif etiketi atar.

        3- Veri On Isleme
            Verilerin uyumlu ve tutarli ozelliklere sahip olmasini saglar.

        4- Veri Artirma
            Veri setine yukarida bahsettigimiz islemler uygulanarak cesitlilik katilir.
        
        5- Surumleme ve Disa Aktarma
            Veri seti benzersiz bir seri numarasi alir ve kullanicin sectigi formatta disa aktarilir.

        6- Egitim ve Dagitim
            Kullanici ister kendi ister RoboFlow uzerinden model egitimini gerceklestirir.

Farkli veri etiketleme platformlari

    1-Labelbox: Coklu veri turlerini (goruntu,ses,video,metin...) desteklemesi en iyi ozelligidir, kalite kontrol ve etiketleyici ekip yonetimi için guclu araclar sunar.

    2-Superb AI: Hizli ve kaliteli segmentasyon ve denetimli etiketleme en onemli ozellikleridir.

    3-Scale AI: Hem platform hem hizmet sunar, yuksek ozellikler gerektiren projeler icin en cok tercih edilendir.

    4-Labelimg: Yalnizca bounding box etiketlemeyi destekler. 

    5-VGG: Bounding box ve cesitli sekilleri destekler, web tabanlidir.

    6-CVAT: farkli birkac tane dosya turu ozelinde veri destegi saglar. Otomatik etiketleme, izleme, is akisi gibi gelismis ozelliklere sahiptir.

    7-Amazon SageMaker: Bulut tabanlidir.

Google Colab ortaminda YOLO training ve detection
    - 5 temel adimdan olusur.
        1- Gerekli kutuphaneleri yuklemek
        2- Veri setimizi Colab'e baglamak
        3- Modelin sinif adlarini ve veri yollarini ogrenmesi icin .yaml dosyasi olusturmak.
        4- Modeli egitmek
        5- Modeli kullanarak yeni goruntuler uzerinde tahminler yapmak